# EMQX 基线配置文件
# IoT设备管理平台 - 通用配置

node {
  name = "iot-emqx@iot-emqx"
  cookie = "emqxsecretcookie"
  data_dir = "/opt/emqx/data"
}

# 监听器配置
listeners {
  tcp {
    default {
      bind = "0.0.0.0:1883"
      max_connections = 1000
      max_conn_rate = 100
    }
  }
  ws {
    default {
      bind = "0.0.0.0:8083"
      max_connections = 1000
    }
  }
}

# Dashboard配置
dashboard {
  default_username = "admin"
  default_password = "public"
  listeners {
    http {
      bind = "0.0.0.0:18083"
    }
  }
}

# 日志配置
log {
  console_handler {
    enable = true
    level = "info"
  }
  file_handlers {
    default {
      enable = true
      level = "info"
      file = "/opt/emqx/log/emqx.log"
    }
  }
}

# 认证配置
allow_anonymous = true

# ACL配置
authorization {
  no_match = "allow"
}

# 消息保留配置
retained {
  max_retained_messages = 10000
  max_payload_size = "1MB"
}

# 会话配置
session {
  max_inflight = 32
  max_awaiting_rel = 100
  await_rel_timeout = "300s"
}